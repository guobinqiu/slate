<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<title>积粒网-完善资料</title>
{% include 'JiliApiBundle::seo.html.twig' %}
<!-- [if lt IE9] -->
<script src="{{ asset('js/html5.js')}}" type="text/javascript"></script>
<!-- [endif] -->
<link href="{{ asset('css/default.css')}}" rel="stylesheet" type="text/css" />
<link href="{{ asset('css/personal.css')}}" rel="stylesheet" type="text/css" />
<link href="{{ asset('css/amazon.css')}}" rel="stylesheet" type="text/css" />
<link href="{{ asset('css/regStep.css')}}" rel="stylesheet" type="text/css" />
<script src="{{ asset('js/jquery-1.7.js')}}" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function(){
      $("#reward").hide();
      $("#getPoint").hide();
      $("#hasReward").hide();
      $("#amazonEmpty").hide();
      {% if isgetReward %}
          {% if isgetReward == 1 %}
              $("#update div").hide();
              $("#getPoint").show();
          {% elseif isgetReward == 2 %}
              $("#update div").hide();
              $("#reward").show();
           {% elseif isgetReward == 3 %}
              $("#update div").hide();
              $("#amazonEmpty").show();
          {% elseif isgetReward == 4 %}
              $("#update div").hide();
              $("#hasReward").show();
          {% else %}
          {% endif %}
      {% else %}
          {% if rsReward==1 %}
              $("#update div").hide();
              $("#getPoint").show();
          {% endif %}
          {% if rsReward==2 %}
              $("#update div").hide();
              $("#reward").show();
          {% endif %}
          {% if rsReward==3 %}
              $("#update div").hide();
              $("#amazonEmpty").show();
          {% endif %}
      {% endif %}
      var year = $("#year");  
      var month = $("#month");  
      var newYear = {{ newYear }};
      var newMonth = {{ newMonth }};
      var yearhtml = '';
      var monthhtml = '';
      var date = new Date();  
      var y = date.getFullYear();  
      yearhtml += "<option value='0'>请选择年</option>";   
      for (var i = 1940; i <= y ; i++) {  
        {% if year %}
            var usernewYear = {{ year }};
            var selected = (usernewYear == i)?"selected='selected'":""; 
        {% else %}
            var selected = (newYear == i)?"selected='selected'":""; 
         {% endif %}
         yearhtml += "<option value='"+i+ "' " + selected+ " >"+i+"</option>";
      } 
      year.html(yearhtml);
      monthhtml += "<option value='0'>请选择月</option>";   
      for (var i = 1; i < 13; i++) {  
          var selected = '';
           {% if month %}
            var usernewMonth = {{ month }};
            var selected = (usernewMonth == i)?"selected='selected'":""; 
          {% endif %}
          if(newMonth) 
              selected = (newMonth == i)?"selected='selected'":""; 
          monthhtml += "<option value='"+i+ "' " + selected+ " >"+i+"</option>"; 
      }
      month.html(monthhtml);
      var html = '';
      {% if provinceId %}
      $.ajax({
            url: "{{ path('_user_getCity') }}?cid={{ provinceId }}",
            type: "POST",
            success:function(data){
              var obj = eval(data);
              for(var i=0;i<obj.length;i++){ 
                  var selected = '';
                 if({{ city }}){
                    var oldcity = {{ city }};
                    selected = ( oldcity == obj[i]['id'])?"selected='selected'":""; 
                 }
                 html += "<option value='"+obj[i]['id']+"'  " + selected+ " >"+obj[i]['cityName']+"</option>";                 
              }
              $("#city").html(html); 
            }
        });
      {% endif %}
      {% if user.province %}
      $.ajax({
            url: "{{ path('_user_getCity') }}?cid={{ user.province }}",
            type: "POST",
            success:function(data){
              var obj = eval(data);
              for(var i=0;i<obj.length;i++){ 
                  var selected = '';
                 if({{ user.city }}){
                    var oldcity = {{ user.city }};
                    selected = ( oldcity == obj[i]['id'])?"selected='selected'":""; 
                 }

                 html += "<option value='"+obj[i]['id']+"'  " + selected+ " >"+obj[i]['cityName']+"</option>";                 
              }
              $("#city").html(html); 
            }
        });
    {% endif %}
});
function selectYear(){
  var month = $("#month"); 
  if($("#year").val()=='0'){
    month.get(0).options.length = 0; 
    month.get(0).options.add(new Option("请选择月", "0"));  
  }else{
    month.get(0).options.length = 0; 
    month.get(0).options.add(new Option("请选择月", "0"));  
    for (var i = 1; i < 13; i++) {  
            month.get(0).options.add(new Option(i, i));  
    }
  }
}
function selectCity(){
  var html = ''; 
  if($("#province").val()!=0){
     $.ajax({
              url: "{{ path('_user_getCity') }}?cid="+$('#province').val(),
              type: "POST",
              success:function(data){
                var obj = eval(data);
                for(var i=0;i<obj.length;i++){ 
                    html += "<option value='"+obj[i]['id']+"'>"+obj[i]['cityName']+"</option>";                 
                }
                $("#city").html(html); 
              }
          });
  }else{
      html += "<option value='0'>请选择地区</option>";   
      $("#city").html(html);
  }
}
</script>
</head>
<body>
{% include 'JiliApiBundle::userHead.html.twig' %}
<div class="amazon">
<div class="banner">
    {% if componType=='activity' %}
          <img src="{{ asset('images/amazonBanner.jpg') }}">
    {% else %}
          <img src="{{ asset('images/codeReward.jpg') }}">
    {% endif %}
</div>
<section id= "update">
    <div id="reward"><p><img src="{{ asset('images/amazonReward.jpg') }}"></p><p>
卡号:<font class='codeReward'>{{ couponCode }}</font></p><p style="margin-top:50px;"><a href='http://count.chanet.com.cn/click.cgi?a=480534&d=283497&u={{ id }}&e=45' target="_blank"><img src="{{ asset('images/amazonHref.jpg') }}"></a></p></div>
<div id="hasReward"><img src="{{ asset('images/haveReward.jpg') }}"></div>
<div id="getPoint"><img src="{{ asset('images/getReward.jpg') }}"></div>
<div id="amazonEmpty"><img src="{{ asset('images/amazonEmpty.jpg') }}"></div>
   <form action="{{ path('_user_registerReward') }}" method="post">
    <div class="content info">
    <div class="regTitle"><img src="{{ asset('images/regTitle.jpg') }}"></div>
      <ul>
        <li>
          <dd>登录账号：</dd>
          <dt>{{ user.email }}  </dt>
        </li>
        <li style="width:40%;">
          <dd>昵  称：</dd>
          <dt>
             {{ user.nick }}
          </dt>
        </li>
        <li style="width:60%;">
          <dd><font style="color:#EE472C;"> * </font>性  别：</dd>
          <dt>
            <input name="sex" type="radio" {% if sex %}{% if sex==1 %} checked='checked' {% endif %}{% endif %}{% if user.sex==1 %} checked='checked' {% endif %} value="1">
            男
            <input name="sex" type="radio" {% if sex %}{% if sex==2 %} checked='checked' {% endif %}{% endif %}{% if user.sex==2 %} checked='checked' {% endif %} value="2">
            女</dt>
        </li>


       <li style="width:40%;"><dd><font style="color:#EE472C;"> * </font>出生年月：</dd>
            <dt><select id="year" name="year" onchange="selectYear()"></select>      
            &nbsp;<select id="month" name="month"></select>      
          </dt>
      </li>

          <li style="width:60%;"><dd><font style="color:#EE472C;"> * </font>地区：</dd>
            <dt><select id="province" name="province" onchange="selectCity()">
            <option value="0">请选择省</option>
              {% for item in province %}
               <option value="{{ item.id }}" {% if provinceId %} {% if provinceId == item.id %} selected = "selected" {% endif %} {% endif %}{% if user.province == item.id %} selected = "selected" {% endif %}>{{ item.provinceName }}</option>
              {% endfor %}
            
            </select>
            <select id="city" name="city"><option value='0'>请选择地区</option>
              </select>
              </dt></li>

        <li>
          <dd>手机号码：</dd>
          <dt>
        <input name="tel" type="text" value="{% if tel %}{{ tel }}{% else %}{{ user.tel }}{% endif %}">
          </dt>
        </li>

         <li>
          <dd><font style="color:#EE472C;"> * </font>月收入：</dd>
          <dt>
           <select id="income" name="income">
           <option value="0">请选择收入</option>
           {% for item in income %}
            <option value="{{ item.id }}" {% if month_income %} {% if month_income == item.id %} selected = "selected" {% endif %} {% endif %}{% if user.income == item.id %} selected = "selected" {% endif %}>{{ item.income }}</option>
            {% endfor %}
            </select>
          </dt>
        </li>

         <li>
          <dd><font style="color:#EE472C;"> * </font>兴趣爱好：</dd>
          <dt>
           {% for item in hobbyList %}
            <input type="checkbox"  name="hobby[]" value="{{ item.id }}" {% if hobby %}{% for i in hobby %} {% if i ==item.id %} checked = "checked" {% endif %}{% endfor %}{% endif %}  {% if newHobby %}{% for i in newHobby %} {% if i ==item.id %} checked = "checked" {% endif %}{% endfor %}{% endif %}>{{ item.hobbyName }}
           {% endfor %}
          </dt>
        </li>
        <li><dd>&nbsp;</dd>
        {% if codeflag  %}
                <font class='codeflag'>{{ codeflag }}</font>
          {% endif %}
          <dt class="submitDt"> 
              {% if componType=='activity' %}
                   <input name="update" type="submit" value="保存" class="infoFinish">
              {% else %}
                   <input name="update" type="submit" value="保存" class="rewardInfoFinish">
              {% endif %}
            
          </dt>
        </li>
      </ul>
    </div>
</form>
  </section>

  </div>
{% include 'JiliApiBundle::userFoot.html.twig' %}
</body>
</html>
