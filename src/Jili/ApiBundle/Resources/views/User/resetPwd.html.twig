<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<title>积粒网-重置密码</title>
<!-- [if lt IE9] -->
<script src="{{ asset('js/html5.js')}}" type="text/javascript"></script>
<!-- [endif] -->
<link href="{{ asset('css/default.css')}}" rel="stylesheet" type="text/css" />
<link href="{{ asset('css/password.css')}}" rel="stylesheet" type="text/css" />
<script src="{{ asset('js/jquery-1.7.js')}}" type="text/javascript"></script>
<script src="{{ asset('js/banner.js')}}" type="text/javascript"></script>
<script type="text/javascript">
var SysSecond; 
$(document).ready(function() { 
    $(".prompt").hide();
}); 
function SetRemainTime() { 
    if (SysSecond > 0) { 
        SysSecond = SysSecond - 1; 
        var second = Math.floor(SysSecond % 60);             // 计算秒     
        $("#second").html(second); 
    } else {
        //window.clearInterval(InterValObj);
    	$("#sendEmail").removeClass('disabled'); 
        $(".prompt").hide();
        $("#sendEmail").attr("onclick","check()"); 
    } 
} 
function check(){
	$.ajax({
		url: "{{ path('_user_reset') }}?email="+$("#email").val(),
		post: "GET",
		success:function(data){
			if(data==1){
				SysSecond = parseInt($("#second").html()); //这里获取倒计时的起始时间 
				InterValObj = window.setInterval(SetRemainTime, 1000); //间隔函数，1秒执行 
				$("#email").val('');
				$(".prompt").show();
				$("#sendEmail").addClass('disabled');
				$("#sendEmail").html('重新发送');
				$("#sendEmail").attr("onclick",""); 
			}else{
				alert('邮件未注册');
				$("#email").val('');
			}
		}
	});
}

</script>
</head>
<body>
{% include 'JiliApiBundle::header.html.twig' %}
<div class="webArticle password">
  <article>
    <div class="form">
      <h2>输入邮箱地址 > <span>重置密码</span></h2>
      <div class="message" style="display:none;"><img src="{{ asset('images/succeed.jpg')}}" width="39" height="44">密码修改成功！</div>
      <p>请输入您注册时填写的邮箱</p>
      <p><input name="email" type="text" class="text" id="email"></p>
      <p><a id="sendEmail" onclick='check();'>下一步</a></p>
      <p class="prompt">重置密码邮件已经发送至您的邮箱，<span id="second">59</span>秒后可重新发送。</p>
      <div class="clear"></div>
    </div>
  </article>
</div>
{% include 'JiliApiBundle::footer.html.twig' %}
</body>
</html>


