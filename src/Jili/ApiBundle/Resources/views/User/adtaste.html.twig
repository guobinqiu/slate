{% extends 'JiliApiBundle::header.html.twig' %}
{% block title %}积粒网-任务历史{% endblock %}

{% block stylesheet %}
<link href="{{ asset('css/default.css')}}" rel="stylesheet" type="text/css" />
<link href="{{ asset('css/personalAside.css')}}" rel="stylesheet" type="text/css" />
<link href="{{ asset('css/history.css')}}" rel="stylesheet" type="text/css" />
<link href="{{ asset('css/pageNav.css')}}" rel="stylesheet" type="text/css" />
{% endblock %}

{% block javascript %}
<script src="{{ asset('js/jquery-1.7.js')}}" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function() {
	var url = window.location.href;
    url = url.split("adtaste/");
    url = url[1].substring(0,1);
    $("div article .screen a").removeClass("hover"); 
    if(url){
    	switch(url){
        case "0":   
            $("div article .screen a:first").addClass("hover");
            break;
        case "1":
             $("div article .screen a:eq(1)").addClass("hover");
            break;
        case "2":
            $("div article .screen a:eq(2)").addClass("hover"); 
            break; 
        case "3":
            $("div article .screen a:last").addClass("hover"); 
            break;
       default:
        	location.href="{{ path('_user_adtaste',{'type': 0}) }}";
            break;
        }
    }
});
function addClass(type){
	switch(type){
        case 0:
        	location.href="{{ path('_user_adtaste',{'type': 0}) }}";
        	break;
        case 1:
        	location.href="{{ path('_user_adtaste',{'type': 1}) }}";
        	break;
        case 2:
        	location.href="{{ path('_user_adtaste',{'type': 2}) }}";
        	break;
        case 3:
        	location.href="{{ path('_user_adtaste',{'type': 3}) }}";
        	break;
        default:
        	location.href="{{ path('_user_adtaste',{'type': 0}) }}";
            break;
	}
}
</script>
{% endblock %}
{% block body %}
<div class="webArticle history">
  <h2><span class="font18 corLightRed crumbTit">任务历史</span></h2>
  <aside>
{% include 'JiliApiBundle:User:rightInfo.html.twig' %}
  </aside>
  <article>
  	<div class="screen">
    <a href="javascript:void(0);" class="hover"  onclick="addClass(0);return false;">全部</a>
  	<a href="javascript:void(0);" onclick="addClass(1);return false;">确认中</a>
  	<a href="javascript:void(0);" onclick="addClass(2);return false;">已完成</a>
  	<a href="javascript:void(0);" onclick="addClass(3);return false;">已拒绝</a>
  	</div>
    <table>
    	<tr>
        	<th>任务类型</th>
            <th>任务名称</th>
            <th>奖励米粒</th>
            <th>更新时间</th>
            <th>任务状态</th>
        </tr>
        {% if adtaste %}
         {% for item in pagination %}
        <tr>
          <td>
         {{ item.displayName }}
          </td>
          <td>{% if item.adid %}
                  <a href="{{ path('_advertiserment_index',{'id':item.adid}) }}" target="_blank">{{ item.title }}</a>
              {% else%}
                  {% if item.incentiveType == 17 %}
                    <a href="{{ path('_advertiserment_list') }}" target="_blank">{{ item.title }}</a>
                  {% elseif item.incentiveType == 18 %}
                    <a href="{{ asset(path('_advertiserment_offer99')) }}" target="_blank">{{ item.title }}</a>
                  {% else %}
                    {{ item.title }}
                  {% endif %}
              {% endif %} 
          </td>
          <td>{% if item.incentiveType==2 or item.incentiveType==19  %}
                     {% if item.orderStatus > 1 %}
                        {{ item.incentive }}米粒
                     {% else %}
                     {% endif %}
              {% else %}
                     {{ item.incentive }}米粒
              {% endif %}</td>
          <td>{% if item.createTime %}{{ item.createTime.date }}{% endif %}</td>
          <td>{% if item.incentiveType==1 or item.incentiveType==2 or item.incentiveType==17 or item.incentiveType==19 %}
                  {% if item.orderStatus==1  %} 已参加
                  {% elseif item.orderStatus==2  %} 确认中
                  {% elseif item.orderStatus==3  %} 已完成
                  {% elseif item.orderStatus==4  %} 已拒绝
                  {% else %}{% endif %}
                  {% else %}
                  {% if item.orderStatus==0  %} 确认中
                  {% elseif item.orderStatus==1  %} 已完成
                  {% else %} 已拒绝
                  {% endif %}
              {% endif %}
          </td>
        </tr>
         {% endfor %}
       {% else %}
      <tr><td align="center" colspan="5">没有任务记录</td></tr>
      {% endif %}
         
    </table>
    {{ knp_pagination_render(pagination) }}
    <div class="prompt">
        <p>*&nbsp;部分商家(如亚马逊)的购买记录可能会延时1~2天显示</p>
        <p>*&nbsp;商家审核需要8周左右（部分商家会有延时情况），判定后立即到账（退货无返利）</p>
    </div>
  </article>
</div>
{% endblock %}
 
 
