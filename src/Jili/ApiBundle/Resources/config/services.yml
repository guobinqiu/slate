parameters:
    user_source.logger.class: Jili\ApiBundle\Services\Logger\UserSourceLogger
    monolog.logger.import_adw_cps.class: Jili\ApiBundle\Services\Logger\ImportAdwCpsLogger
    monolog.processor.session_request.class: Jili\ApiBundle\Services\Session\SessionRequestProcessor

    points_manager.class: Jili\ApiBundle\Services\Points\Manager

    offerwow_api_return.logger.class: Jili\ApiBundle\EventListener\OfferwowApiLogger

    offer99_api_return.logger.class: Jili\ApiBundle\EventListener\Offer99ApiLogger
    offer99_request.validation.class: Jili\ApiBundle\EventListener\Offer99RequestValidation
    offer99_request.processor.class:  Jili\ApiBundle\EventListener\Offer99RequestProcessor

    rebate_activity.caculator.class: Jili\ApiBundle\EventListener\RebateActivity

    cps_access_history.logger.class: Jili\ApiBundle\EventListener\CpsAccessHistoryFactory
    cps_order.factory.class: Jili\ApiBundle\EventListener\CpsOrderFactory

    check_in.listener.class: Jili\ApiBundle\EventListener\CheckInListener


    point_manage.processor.class:  Jili\ApiBundle\EventListener\PointManageProcessor

    send_mail.class:  Jili\ApiBundle\Service\SendMail

# 兑换结果处理
    exchange.processor.class:  Jili\ApiBundle\Services\ExchangeProcess
#AlertToSlack
    alerttoslack.class:  Jili\ApiBundle\Services\AlertToSlack

services:
    user_source.logger:
        class: %user_source.logger.class%
        arguments: ["@logger"]
        tags:
            - { name: monolog.logger, channel: user_source }

    monolog.logger.import_adw_cps:
        class: %monolog.logger.import_adw_cps.class%
        arguments: ["@logger"]
        tags:
            - { name: monolog.logger, channel: import_adw_cps }

    monolog.formatter.session_request:
        class: Monolog\Formatter\LineFormatter
        arguments:
            - "%%datetime%%\t%%extra.token%%\t%%channel%%\t%%level_name%%\t%%message%%\n"

    monolog.processor.session_request:
        class: %monolog.processor.session_request.class%
        arguments:  ["@session"]
        tags:
            - { name: monolog.processor, method: processRecord, channel: user_source }

    # rebate_activity.point_caculator
    rebate_point.caculator:
        class: %rebate_activity.caculator.class%
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]
        calls:
            - [setContainer, ["@service_container"] ]

    points_manager:
        class: %points_manager.class%
        calls:
            - [setLogger, ["@logger"]]
            - [setEntityManager, ["@doctrine.orm.entity_manager"] ]

    offerwow_api.init_log:
        class: %offerwow_api_return.logger.class%
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]

    cps_access_history.logger:
        class: %cps_access_history.logger.class%
        calls:
            - [setLogger, ["@logger"] ]
            - [setEntityManager, ["@doctrine.orm.entity_manager"] ]
            - [setContainer, ["@service_container"] ]

    cps_order.factory:
        class: %cps_order.factory.class%
        calls:
            - [setLogger, ["@logger"] ]
            - [setEntityManager, ["@doctrine.orm.entity_manager"] ]
            - [setContainer, ["@service_container"] ]

    offer99_api.init_log:
        class: %offer99_api_return.logger.class%
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]

    offer99_request.validation:
        class: %offer99_request.validation.class%
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]

    offer99_request.processor:
        class: %offer99_request.processor.class%
        arguments: [ "@logger", "@doctrine.orm.entity_manager", "@app.point_service" ]

    check_in.listener:
        class: %check_in.listener.class%
        calls:
            - [setContainer, ["@service_container"]]
        arguments: ["@doctrine.orm.entity_manager"]
    point_manage.processor:
        class: %point_manage.processor.class%
        calls:
            - [setContainer, ["@service_container"] ]
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]

    send_mail:
        class: %send_mail.class%
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]
        calls:
            - [setContainer, ["@service_container"] ]
            - [setMailer, ["@mailer"] ]

    exchange.processor:
        class: %exchange.processor.class%
        calls:
            - [ setEntityManager, [ @doctrine.orm.entity_manager ] ]
            - [ setLogger, [ @logger ] ]
            - [ setContainer, [ @service_container ] ]

    alert_to_slack:
        class: %alerttoslack.class%
        calls:
            - [ setContainer, [ @service_container ] ]
