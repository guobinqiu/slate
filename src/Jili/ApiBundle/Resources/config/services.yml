parameters:
    login.listener.class: Jili\ApiBundle\EventListener\LoginListener
    soap.mail.listener.class: Jili\ApiBundle\EventListener\SoapMailListener

    general_api.task_history.class: Jili\ApiBundle\EventListener\TaskHistory
    general_api.point_history.class: Jili\ApiBundle\EventListener\PointHistory

    offerwow_api_return.logger.class: Jili\ApiBundle\EventListener\OfferwowApiLogger
    offerwow_request.validation.class: Jili\ApiBundle\EventListener\OfferwowRequestValidation
    offerwow_request.processor.class:  Jili\ApiBundle\EventListener\OfferwowRequestProcessor

    offer99_api_return.logger.class: Jili\ApiBundle\EventListener\Offer99ApiLogger
    offer99_request.validation.class: Jili\ApiBundle\EventListener\Offer99RequestValidation
    offer99_request.processor.class:  Jili\ApiBundle\EventListener\Offer99RequestProcessor

    rebate_activity.caculator.class: Jili\ApiBundle\EventListener\RebateActivity

    cps_access_history.logger.class: Jili\ApiBundle\EventListener\CpsAccessHistoryFactory
    cps_order.factory.class: Jili\ApiBundle\EventListener\CpsOrderFactory

    check_in.listener.class: Jili\ApiBundle\EventListener\CheckInListener

    point_manage.processor.class:  Jili\ApiBundle\EventListener\PointManageProcessor
# session 
    session.task_list.class: Jili\ApiBundle\EventListener\Session\TaskList
    session.my_task_list.class: Jili\ApiBundle\EventListener\Session\MyTaskList
    session.points.class: Jili\ApiBundle\EventListener\Session\Points

# form_handler:
    signup_activate.form_handler.class: Jili\ApiBundle\Form\Handler\SignupActivateHandler

services:
    login.listener:
        class: %login.listener.class%
        arguments: ["@doctrine.orm.entity_manager"]
        calls:
            - [setContainer, ["@service_container"]]
            - [setTaskList, [ @session.task_list ]]

    soap.mail.listener:
        class: %soap.mail.listener.class%
        calls:
            - [setLogger, ["@logger"]]

    # rebate_activity.point_caculator
    rebate_point.caculator:
        class: %rebate_activity.caculator.class%
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]
        calls:
            - [setContainer, ["@service_container"] ] 

    general_api.task_history:
        class: %general_api.task_history.class%
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]

    general_api.point_history:
        class: %general_api.point_history.class%
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]

    offerwow_api.init_log:
        class: %offerwow_api_return.logger.class%
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]

    offerwow_request.validation:
        class: %offerwow_request.validation.class%
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]

    offerwow_request.processor:
        class: %offerwow_request.processor.class%
        calls:
            - [setContainer, ["@service_container"] ] 
            - [setTaskLogger, ["@general_api.task_history"] ]
            - [setPointLogger, ["@general_api.point_history"] ]
            - [setRebatePointCaculator, ["@rebate_point.caculator"] ]

        arguments: [ "@logger","@doctrine.orm.entity_manager" ]

    cps_access_history.logger:
        class: %cps_access_history.logger.class%
        calls:
            - [setLogger, ["@logger"] ]
            - [setEntityManager, ["@doctrine.orm.entity_manager"] ] 
            - [setContainer, ["@service_container"] ] 

    cps_order.factory:
        class: %cps_order.factory.class%
        calls:
            - [setLogger, ["@logger"] ]
            - [setEntityManager, ["@doctrine.orm.entity_manager"] ] 
            - [setContainer, ["@service_container"] ] 

    offer99_api.init_log:
        class: %offer99_api_return.logger.class%
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]

    offer99_request.validation:
        class: %offer99_request.validation.class%
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]

    offer99_request.processor:
        class: %offer99_request.processor.class%
        calls:
            - [setContainer, ["@service_container"] ] 
            - [setTaskLogger, ["@general_api.task_history"] ]
            - [setPointLogger, ["@general_api.point_history"] ]

        arguments: [ "@logger","@doctrine.orm.entity_manager" ]
    check_in.listener:
        class: %check_in.listener.class%
        calls:
            - [setContainer, ["@service_container"]]
        arguments: ["@doctrine.orm.entity_manager"]
    point_manage.processor:
        class: %point_manage.processor.class%
        calls:
            - [setContainer, ["@service_container"] ] 
            - [setTaskLogger, ["@general_api.task_history"] ]
            - [setPointLogger, ["@general_api.point_history"] ]
        arguments: [ "@logger","@doctrine.orm.entity_manager" ]

    session.task_list:
        class: %session.task_list.class%
        arguments: [ %cache_config.session.task_list.keys%,%cache_config.session.task_list.duration%  ]
        calls:
            - [ setContainer, [ @service_container ] ] 
            - [ setLogger, [ @logger ] ] 
            - [ setEntityManager, [ @doctrine.orm.entity_manager ] ] 
            - [ setSession, [ @session ] ] 
            - [ setCheckInListener , [ @check_in.listener ] ]

    session.my_task_list:
        class: %session.my_task_list.class%
        arguments: [ %cache_config.session.my_task_list.keys%,%cache_config.session.my_task_list.duration%  ]
        calls:
            - [ setContainer, [ @service_container ] ] 
            - [ setLogger, [ @logger ] ] 
            - [ setEntityManager, [ @doctrine.orm.entity_manager ] ] 
            - [ setSession, [ @session ] ] 

    session.points:
        class: %session.points.class%
        arguments: [ %cache_config.session.points.keys%,%cache_config.session.points.duration%  ]
        calls:
            - [ setLogger, [ @logger ] ] 
            - [ setEntityManager, [ @doctrine.orm.entity_manager ] ] 
            - [ setSession, [ @session ] ] 

    signup_activate.form_handler:
        class: %signup_activate.form_handler.class%
        calls:
            - [ setLogger, [ @logger ] ] 
            - [ setEntityManager, [ @doctrine.orm.entity_manager ] ] 
            - [ setSession, [ @session ] ] 
            - [ setContainer, [ @service_container ] ] 
            - [ setSoapMailListener, [ "@soap.mail.listener" ] ]
            - [ setLoginListener, [ "@login.listener" ] ]
                

