{% extends 'WenwenFrontendBundle:admin:base.html.twig' %} 

{% block body %}
<div class="tips">注：email必须输入</div>
<div class="text-center search">
    {% if message is defined %}
    <div><em class="tips-error">{{message}}</em></div>
    {% endif %}
    <form action="{{ path('_admin_pointHistorySearch')}}" method="post" id="form1" >
        <div>
            <label for="category_id">积分类型:</label>
            <select id="category_id" name="category_id">
                <option value="0">请选择</option>
                {% for item in categoryList %}
                <option value="{{ item.id }}" {% if item.id==category_id %} selected="selected" {% endif %}>{{item.id }}-{{ item.categoryName }}{{ item.asp }}{{item.displayName }}</option>
                {% endfor %}
            </select>
            <label for="email">email:</label>
            <input type="text" id="email" name="email" value="{% if email %}{{ email }}{% endif %}" size="30" /> 
            <label for="start">开始时间:</label>
            <input id="start" name="start_time" value="{% if start %}{{ start }}{% endif %}" size="18" maxlength="60" readonly="readonly" onclick="WdatePicker()" class="Wdate" style="cursor: pointer" />
            <label for="end">结束时间:</label>
            <input name="end_time" id="end" value="{% if end %}{{ end }}{% endif %}" size="18" maxlength="60" readonly="readonly" onclick="WdatePicker()" class="Wdate" style="cursor: pointer" />&nbsp;
            <input class="btn btn-primary" type="button" id="select" name="select" value="查 询" />&nbsp;
        </div>
    </form>
</div>
<table class="list">
    <tr>
        <th>id</th>
        <th>user id</th>
        <th>point_change_num</th>
        <th>category type</th>
        <th>category name</th>
        <th>create_time</th>
    </tr>
    {% if pagination is defined %} {% for item in pagination %}
    <tr>
        <td>{{ item.id }}</td>
        <td>{{ item.userId }}</td>
        <td>{{ item.pointChangeNum }}</td>
        <td>{{ item.reason }}</td>
        <td>{{ item.categoryName }}</td>
        <td>{{ item.createTime | date('y-m-d h:i:s') }}
        </td>
    </tr>
    {% endfor %} {% endif %}
</table>

{% if pagination is defined %}{{ knp_pagination_render(pagination) }}{% endif %}
{% endblock %}

{% block extra_js %}
<script type="text/javascript">
$(document).ready(function(){
  $("#select").click(function (){
      var email = $.trim($("#email").val());
      if( email == null || email == ""){
          alert("请输入email");
          return false;
      }
      window.location.href="{{ path('_admin_pointHistorySearch') }}?start="+$('#start').val()+"&end="+$('#end').val()+"&category_id="+$('#category_id').val()+"&email="+$('#email').val();
  })
});
</script>
{% endblock %}